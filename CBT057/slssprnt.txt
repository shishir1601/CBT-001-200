PROC 0
  ISPEXEC VGET (DEBUG SLSS CIBSRTKY CIBNUMBR LIBADMIN CIBOWNER) SHARED
  IF &DEBUG = DEBUG THEN DO
      CONTROL MSG LIST CONLIST SYMLIST
      ISPEXEC  CONTROL DISPLAY  LINE SM
  END DO
  ELSE DO
      CONTROL NOMSG
  END DO
  ISPEXEC CONTROL ERRORS RETURN
  SET SLSS = &STR(DUMM)
INIT: +
  ISPEXEC DISPLAY PANEL(SLSSPRNT)
  IF &LASTCC ^= 0 THEN DO
    EXIT CODE(00)
  END DO
DISPLAY: +
  IF &SLSSRPT = 3 OR &SLSSRPT = 5 OR &SLSSRPT = 6 THEN DO
    ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER
      SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      GOTO INIT
    END DO
    SET SL = &STR( )
    ISPEXEC TBDISPL SLSSCNTL PANEL(SLSSMSTR)
    SET RC = &LASTCC
    IF &RC = 8 THEN GOTO INIT
    IF &RC > 8 THEN DO
      SET SLSSERR1 = UNABLE TO DISPLAY LIBRARY SELECTION LIST.
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBDISPL' WAS &RC.
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER
      SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      GOTO INIT
    END DO
    SET SLSS = &CIBN
    ISPEXEC TBEND SLSSCNTL
  END DO
  IF &SLSSRPT = 6 THEN DO
    ISPEXEC DISPLAY PANEL(SLSSBK1)
    IF &LASTCC ^= 0 THEN DO
      GOTO INIT
    END DO
    IF &STR(&BID60) ^= &STR( ) THEN DO
      ISPEXEC DISPLAY PANEL(SLSSBK2)
    END DO
    ISPEXEC TBCREATE BOOKIDS REPLACE -
    NAMES(BID1  BID2  BID3  BID4  BID5  BID6  BID7  BID8  BID9  BID10 -
          BID11 BID12 BID13 BID14 BID15 BID16 BID17 BID18 BID19 BID20 -
          BID21 BID22 BID23 BID24 BID25 BID26 BID27 BID28 BID29 BID30 -
          BID31 BID32 BID33 BID34 BID35 BID36 BID37 BID38 BID39 BID40 -
          BID41 BID42 BID43 BID44 BID45 BID46 BID47 BID48 BID49 BID50 -
          BID51 BID52 BID53 BID54 BID55 BID56 BID57 BID58 BID59 BID60 -
          BID61 BID62 BID63 BID64 BID65 BID66 BID67 BID68 BID69 BID70 -
          BID81 BID82 BID83 BID84 BID85 BID86 BID87 BID88 BID89 BID90 -
          BID91 BID92 BID93 BID94 BID95 BID96 BID97 BID98 BID99 BID100 -
          BID101 BID102 BID103 BID104 BID105 BID106 BID107 BID108 BID109 BID110 -
          BID111 BID112 BID113 BID114 BID115 BID116 BID117 BID118 BID119 BID120)
    SET RC = &LASTCC
    IF &RC > 4 THEN DO
      SET SLSSERR1 = UNABLE TO CREATE THE REQUESTED LIBRARY, BOOKIDS.
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCREATE' WAS &RC..
      SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
      SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND BOOKIDS
      GOTO INIT
    END DO
    ISPEXEC TBADD BOOKIDS
    ISPEXEC TBCLOSE BOOKIDS LIBRARY(SLSSTLIB)
  END DO
SUBMIT1: +
  ISPEXEC TBEND  SLSSPROF
  ISPEXEC TBOPEN SLSSPROF
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    %SLSSPROF &SYSUID &DEBUG
    SET PROFRC = &LASTCC
    IF &PROFRC ^= 0 THEN DO
      SET SLSSWRN1 = UNABLE TO CREATE YOUR SLSS PROFILE.
      SET SLSSWRN2 = BE SURE JOB CARDS ARE CORRECT BEFORE SUBMITTING JOBS.
      SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSWRN4 = REGARDING THIS ERROR.
      SET SLSSWRN5 =
      SET SLSSWRNX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@WRN)
      GOTO SUBMIT2
    END DO
    ISPEXEC TBOPEN SLSSPROF
    SET RC = 0
  END DO
  IF &RC ^= 0 THEN DO
    SET SLSSWRN1 = UNABLE TO OPEN YOUR SLSS PROFILE.
    SET SLSSWRN2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
    SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSWRN4 = REGARDING THIS ERROR.
    SET SLSSWRN5 =
    SET SLSSWRNX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@WRN)
    GOTO SUBMIT2
  END DO
  ISPEXEC TBTOP SLSSPROF
  ISPEXEC TBVCLEAR SLSSPROF
  SET SLSSUSR = &STR(&SYSUID)
  ISPEXEC TBSKIP SLSSPROF
  SET SKIPRC = &LASTCC
  IF &SKIPRC ^= 0 THEN DO
    SET SLSSWRN1 = UNABLE TO OBTAIN INFORMATION FROM YOUR SLSS PROFILE.
    SET SLSSWRN2 = RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &SKIPRC..
    SET SLSSWRN3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSWRN4 = REGARDING THIS ERROR.
    SET SLSSWRN5 =
    SET SLSSWRNX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@WRN)
  END DO
  GOTO SUBMIT2
SUBMIT2: +
  IF &STR(&SLSSJOB1) = &STR() THEN DO
    ISPEXEC VGET (ZLLGJOB1 ZLLGJOB2 ZLLGJOB3 ZLLGJOB4)
    SET SLSSJOB1 = &STR(&ZLLGJOB1)
    SET SLSSJOB2 = &STR(&ZLLGJOB2)
    SET SLSSJOB3 = &STR(&ZLLGJOB3)
    SET SLSSJOB4 = &STR(&ZLLGJOB4)
    SET MESSAGE = &STR(UPDATE/VERIFY JOB STATEMENT INFORMATION OR PRESS END KEY TO RETURN)
    ISPEXEC DISPLAY PANEL(SLSSJOBC)
    SET RC = &LASTCC
    IF &RC = 8 THEN DO
      ISPEXEC TBEND SLSSPROF
      GOTO INIT
    END DO
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO DISPLAY SLSS JOB CARD SETUP PANEL.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSPROF
      GOTO INIT
    END DO
  END DO
SUBMIT3: +
  SET MESSAGE = &STR(PRESS ENTER TO SUBMIT JOB OR PRESS END KEY TO RE-UPDATE/VERIFY)
  ISPEXEC DISPLAY PANEL(SLSSJOBC)
  SET RC = &LASTCC
  IF &RC ^= 8 THEN GOTO SUBMIT4
  SET MESSAGE = &STR(UPDATE/VERIFY JOB STATEMENT INFORMATION OR PRESS END KEY TO RETURN)
  ISPEXEC DISPLAY PANEL(SLSSJOBC)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND SLSSPROF
    GOTO INIT
  END DO
  GOTO SUBMIT3
SUBMIT4: +
  SET SLSSINDX = &SLSSINDX + 1
  IF &SLSSINDX = 27 THEN SET SLSSINDX = 1
  SET TEMPNAME = &STR(//&SLSSUSR.&SUBSTR(&SLSSINDX:&SLSSINDX,&STR(ABCDEFGHIJKLMNOPQRSTUVWXYZ)))
  SET TEMPLEN = &LENGTH(&STR(&SLSSJOB1))
  SET SLSSJOB1 = &STR(&TEMPNAME.&SUBSTR(10:&TEMPLEN,&SLSSJOB1))
  ISPEXEC TBPUT SLSSPROF
  ISPEXEC TBCLOSE SLSSPROF
  SET SLSSPARM = &STR(&SLSSRPT &SLSSSEQ &SLSSPRT &SLSSLINE &SLSSFORM &SLSS)
  ISPEXEC VPUT (SLSSJOB1 SLSSJOB2 SLSSJOB3 SLSSJOB4 SLSSDSN SLSSPARM SLSSUSR)
  ISPEXEC FTOPEN TEMP
  ISPEXEC FTINCL SLSSPRNT
  ISPEXEC FTCLOSE
  ISPEXEC VGET (ZTEMPF)
  IF &DEBUG ^= &STR(  ) THEN DO
    ISPEXEC EDIT  DATASET('&ZTEMPF')
  END DO
  SUBMIT '&ZTEMPF'
  GOTO INIT
