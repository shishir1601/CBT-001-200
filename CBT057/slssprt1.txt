PROC 6 SLSSRPT SLSSSEQ SLSSPRT SLSSLINE SLSSFORM SLSS
  CONTROL NOMSG
  SET FS = &STR(                                                                                          )
  SET DSNCNT = 0
  SET PRTRTN = &STR(N)
  SET SAVELINE = &STR( )
  ISPEXEC CONTROL ERRORS RETURN
OUTFILE: +
  FREE F(SLSSOUT)
  SET FORM = &STR(P014)
  IF &SLSSFORM = &STR(2) THEN DO
    SET FORM = &STR(P001)
  END DO
  IF &SLSSRPT = &STR(5) OR &SLSSRPT = &STR(6) OR &SLSSRPT = &STR(7) THEN DO
    IF &SLSSRPT ^= &STR(7) THEN DO
      SET TIME = &STR(&SYSTIME)
      SET HOUR = &SUBSTR(1:2,&TIME&FS)
      SET MIN = &SUBSTR(4:5,&TIME&FS)
      SET SEC = &SUBSTR(7:8,&TIME&FS)
      SET SLSSDSN = &STR(&SYSUID..T&HOUR&MIN&SEC..SLSSTEXT)
      DELETE &SLSSDSN
      ALLOC F(SLSSOUT) DA(&SLSSDSN) NEW CATALOG SPACE(1 1) CYLINDER LRECL(256) BLKSIZE(6148) RECFM(V B)
    END DO
    ELSE DO
      SET TIME = &STR(&SYSTIME)
      SET HOUR = &SUBSTR(1:2,&TIME&FS)
      SET MIN = &SUBSTR(4:5,&TIME&FS)
      SET SEC = &SUBSTR(7:8,&TIME&FS)
      SET SLSSDSN = &STR(&SYSUID..T&HOUR&MIN&SEC..LOCS)
      DELETE &SLSSDSN
      ALLOC F(SLSSOUT) DA(&SLSSDSN) NEW CATALOG SPACE(1 1) CYLINDER LRECL(80) BLKSIZE(6240) RECFM(F B)
    END DO
  END DO
  ELSE DO
    IF &SLSSPRT = &STR(1) THEN DO
      ALLOC F(SLSSOUT) SYSOUT(G) DEST(FETCH) FORM(&FORM) LRECL(91) BLKSIZE(5460) RECFM(F B A)
    END DO
    ELSE DO
      ALLOC F(SLSSOUT) SYSOUT(A) DEST(FETCH) LRECL(91) BLKSIZE(5460) RECFM(F B A)
    END DO
  END DO
  OPENFILE SLSSOUT OUTPUT
SETPAGE: +
  SET PAGNUM = 0
  SET MAXLN = 59
  SET CHKMXS = 56
  SET CHKMXD = 53
  IF &SLSSLINE = &STR(S) THEN DO
    SET CR = &STR( )
  END DO
  ELSE DO
    SET CR = &STR(0)
  END DO
RPT1: +
  IF &SLSSRPT ^= &STR(1) THEN GOTO RPT2
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(MAIN)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN COMPLETE SLSS LIBRARY, MAIN.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
SORT1: +
  IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR1
  IF &STR(&SLSSSEQ) = B THEN +
      SET FIELD = &STR(BOOK)
  IF &STR(&SLSSSEQ) = M THEN +
      SET FIELD = &STR(SLSSRTKY)
  IF &STR(&SLSSSEQ) = T THEN +
      SET FIELD = &STR(NAME1)
  ISPEXEC TBSORT MAIN FIELDS(&FIELD,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
SETHDR1: +
  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
  SET CSLS = &SUBSTR(1:4,&STR(MAIN&FS))
  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
  SET HDR0B = &STR( REPORT                      PAGE:  )
  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
  SET HDR4A = &STR(   ---------------------------------------------)
  SET HDR4B = &STR(------------------------------------------)
  IF &SLSSSEQ = &STR(B) THEN DO
    SET HDR2A = &STR(                                    BINDER SE)
    SET HDR2B = &STR(QUENCE LISTING                               )
    SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
    SET HDR3B = &STR(                TITLE                          )
    GOTO PRTHDR1
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET HDR2A = &STR(                                     TITLE SE)
    SET HDR2B = &STR(QUENCE LISTING                               )
    SET HDR3A = &STR(                              TITLE          )
    SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
    GOTO PRTHDR1
  END DO
  SET HDR2A = &STR(                                   MANUAL-ID )
  SET HDR2B = &STR(SEQUENCE LISTING                             )
  SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
  SET HDR3B = &STR(                 TITLE                          )
  GOTO PRTHDR1
PRTHDR1: +
  SET PAGNUM = &PAGNUM + 1
  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR2A&HDR2B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR1A&HDR1B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(   )
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR3A&HDR3B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR4A&HDR4B)
  PUTFILE SLSSOUT
  SET LNCNT = 6
  IF &PRTRTN = &STR(Y) THEN DO
    SET SLSSOUT = &STR(&SAVELINE)
    SET PRTRTN = &STR(N)
    GOTO PRTLIN11
  END DO
LOOPTBL1: +
  SET BYPASS = &STR(N)
  SET SLSSOUT = &STR( )
  ISPEXEC TBSKIP MAIN NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND MAIN
    WRITE ========================================
    WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, 'MAIN'.
    WRITE ========================================
    GOTO ENDRPT
  END DO
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
SETLIN11: +
  IF &SLSSSEQ = &STR(B) THEN DO
    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
    GOTO PRTLIN11
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
    GOTO PRTLIN11
  END DO
  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
  GOTO PRTLIN11
PRTLIN11: +
  IF &SLSSLINE = &STR(S) THEN DO
    IF &LNCNT > &CHKMXS THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR1
    END DO
  END DO
  ELSE DO
    IF &LNCNT > &CHKMXD THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR1
    END DO
  END DO
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN12: +
  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN1
  SET R1 = &SUBSTR(1:9,&STR(&FS))
  SET R2 = &SUBSTR(1:8,&STR(&FS))
  SET R3 = &SUBSTR(1:1,&STR(&FS))
  SET R4 = &SUBSTR(1:2,&STR(&FS))
  SET R5 = &SUBSTR(1:2,&STR(&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
  SET R7 = &SUBSTR(1:8,&STR(&FS))
  IF &SLSSSEQ = &STR(B) THEN DO
    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
    GOTO PRTLIN12
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
    GOTO PRTLIN12
  END DO
  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
  GOTO PRTLIN12
PRTLIN12: +
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN13: +
  IF &BYPASS = &STR(Y) THEN GOTO CHKLN1
  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN1
  SET BYPASS = &STR(Y)
  SET NAME2 = &STR(&NAME3)
  SET NAME3 = &STR( )
  GOTO SETLIN12
CHKLN1: +
  IF &LNCNT < &MAXLN THEN DO
    GOTO LOOPTBL1
  END DO
  ELSE DO
    GOTO PRTHDR1
  END DO
RPT2: +
  IF &SLSSRPT ^= &STR(2) THEN GOTO RPT3
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(MAIN)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  SET CNT = 0
  DO WHILE &CNT < 120
    SET CNT = &CNT + 1
    SET PF  = &STR(&&SLB&CNT)
    SET SAVSLB&CNT = &STR(&PF)
  END DO
  SET CNT = 1
  SET PF  = &STR(&&SAVSLB&CNT)
  SET SLSS = &STR(&PF)
  IF &SLSS = &STR() THEN SET &CNT = 121
  IF &SLSS = &STR(MAIN) THEN GOTO NEXTLIB2
  DO WHILE &CNT < 121
    ISPEXEC TBTOP SLSSCNTL
    ISPEXEC TBVCLEAR SLSSCNTL
    SET CIBN = &STR(&SLSS)
    ISPEXEC TBSARG SLSSCNTL
    ISPEXEC TBSCAN SLSSCNTL
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY '&SLSS'.
      WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
      WRITE INFORMATION REGARDING THIS ERROR.
      WRITE ========================================
      GOTO NEXTLIB2
    END DO
    ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      WRITE UNABLE TO OPEN LIBRARY, &SLSS, FOR PRINT.
      WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
      WRITE INFORMATION REGARDING THIS ERROR.
      WRITE ========================================
      ISPEXEC TBEND &SLSS
      GOTO NEXTLIB2
    END DO
SORT2: +
    IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR2
    IF &STR(&SLSSSEQ) = B THEN +
        SET FIELD = &STR(BOOK)
    IF &STR(&SLSSSEQ) = M THEN +
        SET FIELD = &STR(SLSSRTKY)
    IF &STR(&SLSSSEQ) = T THEN +
        SET FIELD = &STR(NAME1)
    ISPEXEC TBSORT &SLSS FIELDS(&FIELD,C,A)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
      WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      WRITE REGARDING THIS ERROR.
      WRITE ========================================
      ISPEXEC TBEND &SLSS
      GOTO NEXTLIB2
    END DO
SETHDR2: +
    SET PAGNUM = 0
    SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
    SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
    SET CSLS = &SUBSTR(1:4,&STR(&SLSS&FS))
    SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
    SET HDR0B = &STR( REPORT                      PAGE:  )
    SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
    SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
    SET HDR4A = &STR(   ---------------------------------------------)
    SET HDR4B = &STR(------------------------------------------)
    IF &SLSSSEQ = &STR(B) THEN DO
      SET HDR2A = &STR(                                    BINDER SE)
      SET HDR2B = &STR(QUENCE LISTING                               )
      SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
      SET HDR3B = &STR(                TITLE                          )
      GOTO PRTHDR2
    END DO
    IF &SLSSSEQ = &STR(T) THEN DO
      SET HDR2A = &STR(                                     TITLE SE)
      SET HDR2B = &STR(QUENCE LISTING                               )
      SET HDR3A = &STR(                              TITLE          )
      SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
      GOTO PRTHDR2
    END DO
    SET HDR2A = &STR(                                   MANUAL-ID )
    SET HDR2B = &STR(SEQUENCE LISTING                             )
    SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
    SET HDR3B = &STR(                 TITLE                          )
    GOTO PRTHDR2
PRTHDR2: +
    SET PAGNUM = &PAGNUM + 1
    SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR( &HDR2A&HDR2B)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR( &HDR1A&HDR1B)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(   )
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR( &HDR3A&HDR3B)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR( &HDR4A&HDR4B)
    PUTFILE SLSSOUT
    SET LNCNT = 6
    IF &PRTRTN = &STR(Y) THEN DO
      SET SLSSOUT = &STR(&SAVELINE)
      SET PRTRTN = &STR(N)
      GOTO PRTLIN21
    END DO
LOOPTBL2: +
    SET BYPASS = &STR(N)
    SET SLSSOUT = &STR( )
    ISPEXEC TBSKIP &SLSS NUMBER(+1)
    SET RC = &LASTCC
    IF &RC = 8 THEN DO
      ISPEXEC TBEND &SLSS
      WRITE ========================================
      WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
      WRITE ========================================
      GOTO NEXTLIB2
    END DO
    IF &RC ^= 0 THEN DO
      WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR REPORT.
      WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
      WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
      WRITE INFORMATION REGARDING THIS ERROR.
      WRITE ========================================
      ISPEXEC TBEND &SLSS
      GOTO NEXTLIB2
    END DO
    SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
    SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
    SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
    SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
    SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
    SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
    SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
SETLIN21: +
    IF &SLSSSEQ = &STR(B) THEN DO
      SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
      GOTO PRTLIN21
    END DO
    IF &SLSSSEQ = &STR(T) THEN DO
      SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
      GOTO PRTLIN21
    END DO
    SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
    GOTO PRTLIN21
PRTLIN21: +
    IF &SLSSLINE = &STR(S) THEN DO
      IF &LNCNT > &CHKMXS THEN DO
        SET SAVELINE = &STR(&SLSSOUT)
        SET PRTRTN = &STR(Y)
        GOTO PRTHDR2
      END DO
    END DO
    ELSE DO
      IF &LNCNT > &CHKMXD THEN DO
        SET SAVELINE = &STR(&SLSSOUT)
        SET PRTRTN = &STR(Y)
        GOTO PRTHDR2
      END DO
    END DO
    PUTFILE SLSSOUT
    IF &CR = &STR( ) THEN DO
      SET LNCNT = &LNCNT + 1
    END DO
    ELSE DO
      SET LNCNT = &LNCNT + 2
    END DO
SETLIN22: +
    IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN2
    SET R1 = &SUBSTR(1:9,&STR(&FS))
    SET R2 = &SUBSTR(1:8,&STR(&FS))
    SET R3 = &SUBSTR(1:1,&STR(&FS))
    SET R4 = &SUBSTR(1:2,&STR(&FS))
    SET R5 = &SUBSTR(1:2,&STR(&FS))
    SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
    SET R7 = &SUBSTR(1:8,&STR(&FS))
    IF &SLSSSEQ = &STR(B) THEN DO
      SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
      GOTO PRTLIN22
    END DO
    IF &SLSSSEQ = &STR(T) THEN DO
      SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
      GOTO PRTLIN22
    END DO
    SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
    GOTO PRTLIN22
PRTLIN22: +
    PUTFILE SLSSOUT
    IF &CR = &STR( ) THEN DO
      SET LNCNT = &LNCNT + 1
    END DO
    ELSE DO
      SET LNCNT = &LNCNT + 2
    END DO
SETLIN23: +
    IF &BYPASS = &STR(Y) THEN GOTO CHKLN2
    IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN2
    SET BYPASS = &STR(Y)
    SET NAME2 = &STR(&NAME3)
    SET NAME3 = &STR( )
    GOTO SETLIN22
CHKLN2: +
    IF &LNCNT < &MAXLN THEN DO
      GOTO LOOPTBL2
    END DO
    ELSE DO
      GOTO PRTHDR2
    END DO
NEXTLIB2: +
    SET CNT = &CNT + 1
    SET PF  = &STR(&&SAVSLB&CNT)
    SET SLSS = &STR(&PF)
    IF &SLSS = &STR() THEN SET &CNT = 121
    IF &SLSS = &STR(MAIN) THEN GOTO NEXTLIB2
  END DO
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC CONTROL ERRORS RETURN
  WRITE ========================================
  WRITE REPORT PROCESSING COMPLETE FOR ALL LIBRARIES.
  WRITE ========================================
  GOTO ENDRPT
RPT3: +
  IF &SLSSRPT ^= &STR(3) THEN GOTO RPT4
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(&SLSS)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
SORT3: +
  IF &SLSSSEQ = &STR(&CIBSRTKY) THEN GOTO SETHDR3
  IF &STR(&SLSSSEQ) = B THEN +
      SET FIELD = &STR(BOOK)
  IF &STR(&SLSSSEQ) = M THEN +
      SET FIELD = &STR(SLSSRTKY)
  IF &STR(&SLSSSEQ) = T THEN +
      SET FIELD = &STR(NAME1)
  ISPEXEC TBSORT &SLSS FIELDS(&FIELD,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
SETHDR3: +
  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
  SET CSLS = &SUBSTR(1:4,&STR(&SLSS&FS))
  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
  SET HDR0B = &STR( REPORT                      PAGE:  )
  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
  SET HDR4A = &STR(   ---------------------------------------------)
  SET HDR4B = &STR(------------------------------------------)
  IF &SLSSSEQ = &STR(B) THEN DO
    SET HDR2A = &STR(                                    BINDER SE)
    SET HDR2B = &STR(QUENCE LISTING                               )
    SET HDR3A = &STR(    BINDER  MANUAL-ID VER NUM S            )
    SET HDR3B = &STR(                TITLE                          )
    GOTO PRTHDR3
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET HDR2A = &STR(                                     TITLE SE)
    SET HDR2B = &STR(QUENCE LISTING                               )
    SET HDR3A = &STR(                              TITLE          )
    SET HDR3B = &STR(                 MANUAL-ID  BINDER  VER NUM S)
    GOTO PRTHDR3
  END DO
  SET HDR2A = &STR(                                   MANUAL-ID )
  SET HDR2B = &STR(SEQUENCE LISTING                             )
  SET HDR3A = &STR(   MANUAL-ID  BINDER  VER NUM S           )
  SET HDR3B = &STR(                 TITLE                          )
  GOTO PRTHDR3
PRTHDR3: +
  SET PAGNUM = &PAGNUM + 1
  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR2A&HDR2B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR1A&HDR1B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(   )
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR3A&HDR3B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR4A&HDR4B)
  PUTFILE SLSSOUT
  SET LNCNT = 6
  IF &PRTRTN = &STR(Y) THEN DO
    SET SLSSOUT = &STR(&SAVELINE)
    SET PRTRTN = &STR(N)
    GOTO PRTLIN31
  END DO
LOOPTBL3: +
  SET BYPASS = &STR(N)
  SET SLSSOUT = &STR( )
  ISPEXEC TBSKIP &SLSS NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND &SLSS
    WRITE ========================================
    WRITE REPORT PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
    WRITE ========================================
    GOTO ENDRPT
  END DO
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY &SLSS FOR REPORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
SETLIN31: +
  IF &SLSSSEQ = &STR(B) THEN DO
    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
    GOTO PRTLIN31
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
    GOTO PRTLIN31
  END DO
  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
  GOTO PRTLIN31
PRTLIN31: +
  IF &SLSSLINE = &STR(S) THEN DO
    IF &LNCNT > &CHKMXS THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR3
    END DO
  END DO
  ELSE DO
    IF &LNCNT > &CHKMXD THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR3
    END DO
  END DO
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN32: +
  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN3
  SET R1 = &SUBSTR(1:9,&STR(&FS))
  SET R2 = &SUBSTR(1:8,&STR(&FS))
  SET R3 = &SUBSTR(1:1,&STR(&FS))
  SET R4 = &SUBSTR(1:2,&STR(&FS))
  SET R5 = &SUBSTR(1:2,&STR(&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
  SET R7 = &SUBSTR(1:8,&STR(&FS))
  IF &SLSSSEQ = &STR(B) THEN DO
    SET SLSSOUT = &STR(&CR   &R2  &R1 &R4  &R5  &R3 &R6)
    GOTO PRTLIN32
  END DO
  IF &SLSSSEQ = &STR(T) THEN DO
    SET SLSSOUT = &STR(&CR   &R6 &R1 &R2 &R4  &R5  &R3)
    GOTO PRTLIN32
  END DO
  SET SLSSOUT = &STR(&CR   &R1 &R2 &R4  &R5  &R3 &R6)
  GOTO PRTLIN32
PRTLIN32: +
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN33: +
  IF &BYPASS = &STR(Y) THEN GOTO CHKLN3
  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN3
  SET BYPASS = &STR(Y)
  SET NAME2 = &STR(&NAME3)
  SET NAME3 = &STR( )
  GOTO SETLIN32
CHKLN3: +
  IF &LNCNT < &MAXLN THEN DO
    GOTO LOOPTBL3
  END DO
  ELSE DO
    GOTO PRTHDR3
  END DO
RPT4: +
  IF &SLSSRPT ^= &STR(4) THEN GOTO RPT5
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(MAIN)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OBTAIN INFORMATION FOR LIBRARY 'MAIN'.
    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND SLSSCNTL
    GOTO ENDRPT
  END DO
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN COMPLETE SLSS LIBRARY, MAIN.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
SORT4: +
  IF &CIBSRTKY = &STR(M) THEN GOTO SETHDR4
  SET FIELD = &STR(SLSSRTKY)
  ISPEXEC TBSORT MAIN FIELDS(&FIELD,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
SETHDR4: +
  SET CNAM = &SUBSTR(1:20,&STR(&CIBNAME&FS))
  SET COWN = &SUBSTR(1:6,&STR(&CIBOWNER&FS))
  SET CSLS = &SUBSTR(1:4,&STR(MAIN&FS))
  SET HDR0A = &STR(    &SYSDATE                          ISL LIBRARY)
  SET HDR0B = &STR( REPORT                      PAGE:  )
  SET HDR1A = &STR(    LIBRARY ID: &CSLS               NAME: )
  SET HDR1B = &STR(&CNAM               OWNER: &COWN   )
  SET HDR4A = &STR(   ---------------------------------------------)
  SET HDR4B = &STR(------------------------------------------)
  SET HDR2A = &STR(                                    MANUALS ON)
  SET HDR2B = &STR( ORDER LISTING                              )
  SET HDR3A = &STR(   MANUAL-ID   DATE ORD                       )
  SET HDR3B = &STR(       TITLE                                )
  GOTO PRTHDR4
PRTHDR4: +
  SET PAGNUM = &PAGNUM + 1
  SET SLSSOUT = &STR(1&HDR0A&HDR0B&PAGNUM)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR2A&HDR2B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR1A&HDR1B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(   )
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR3A&HDR3B)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR( &HDR4A&HDR4B)
  PUTFILE SLSSOUT
  SET LNCNT = 6
  IF &PRTRTN = &STR(Y) THEN DO
    SET SLSSOUT = &STR(&SAVELINE)
    SET PRTRTN = &STR(N)
    GOTO PRTLIN41
  END DO
LOOPTBL4: +
  SET BYPASS = &STR(N)
  SET SLSSOUT = &STR( )
  ISPEXEC TBSKIP MAIN NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND MAIN
    WRITE ========================================
    WRITE REPORT PROCESSING COMPLETE FOR MANUALS ON ORDER.
    WRITE ========================================
    GOTO ENDRPT
  END DO
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
  IF &STR(&ORDSTS) = &STR( ) THEN GOTO LOOPTBL4
  SET R1 = &SUBSTR(1:9,&STR(&SLSID&FS))
  SET R2 = &SUBSTR(1:8,&STR(&BOOK&FS))
  SET R3 = &SUBSTR(1:1,&STR(&ORDSTS&FS))
  SET R4 = &SUBSTR(1:2,&STR(&SLSSVER&FS))
  SET R5 = &SUBSTR(1:2,&STR(&SLSSNUM&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME1&FS))
  SET R7 = &SUBSTR(1:8,&STR(&DATEORD&FS))
SETLIN41: +
  IF &STR(&R6) ^= &STR( ) THEN DO
    SET SLSSOUT = &STR(&CR   &R1   &R7   &R6)
    GOTO PRTLIN41
  END DO
  GOTO LOOPTBL4
PRTLIN41: +
  IF &SLSSLINE = &STR(S) THEN DO
    IF &LNCNT > &CHKMXS THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR4
    END DO
  END DO
  ELSE DO
    IF &LNCNT > &CHKMXD THEN DO
      SET SAVELINE = &STR(&SLSSOUT)
      SET PRTRTN = &STR(Y)
      GOTO PRTHDR4
    END DO
  END DO
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN42: +
  IF &STR(&NAME2) = &STR( ) THEN GOTO CHKLN4
  SET R1 = &SUBSTR(1:9,&STR(&FS))
  SET R2 = &SUBSTR(1:8,&STR(&FS))
  SET R3 = &SUBSTR(1:1,&STR(&FS))
  SET R4 = &SUBSTR(1:2,&STR(&FS))
  SET R5 = &SUBSTR(1:2,&STR(&FS))
  SET R6 = &SUBSTR(1:58,&STR(&NAME2&FS))
  SET R7 = &SUBSTR(1:8,&STR(&FS))
  SET SLSSOUT = &STR(&CR   &R1   &R7   &R6)
  GOTO PRTLIN42
PRTLIN42: +
  PUTFILE SLSSOUT
  IF &CR = &STR( ) THEN DO
    SET LNCNT = &LNCNT + 1
  END DO
  ELSE DO
    SET LNCNT = &LNCNT + 2
  END DO
SETLIN43: +
  IF &BYPASS = &STR(Y) THEN GOTO CHKLN4
  IF &STR(&NAME3) = &STR( ) THEN GOTO CHKLN4
  SET BYPASS = &STR(Y)
  SET NAME2 = &STR(&NAME3)
  SET NAME3 = &STR( )
  GOTO SETLIN42
CHKLN4: +
  IF &LNCNT < &MAXLN THEN DO
    GOTO LOOPTBL4
  END DO
  ELSE DO
    GOTO PRTHDR4
  END DO
RPT5: +
  IF &SLSSRPT ^= &STR(5) THEN GOTO RPT6
  SET SLSSPRNT = &STR(SLSSXICS)
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(&SLSS)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
SORT5: +
  ISPEXEC TBSORT &SLSS FIELDS(BOOK,C,A,SLSSRTKY,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
  SET SLSSOUT = &STR(<HYP,0,0,0>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<FNT1=F,2,1/PT,11,12>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<FNT2=F,2,1/PT,18,20>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN1=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,180,34>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN2=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,354,208>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN3=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,528,382>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN1=<PD,542/PW,760/R,2,1/PT,11,0/SP,10/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN2=<PD,542/PW,760/R,2,1/PT,11,0/SP,184/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN3=<PD,542/PW,760/R,2,1/PT,11,0/SP,358/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID1=<FNT1/SP,1/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID2=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID3=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID4=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID5=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID6=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID7=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID8=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID9=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDA =<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDB=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDC=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#TITL=<FNT1/QL,690,296>>)
  PUTFILE SLSSOUT
  ISPEXEC TBVCLEAR &SLSS
  ISPEXEC TBSKIP &SLSS NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND &SLSS
    WRITE ========================================
    WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
    WRITE ========================================
    GOTO SUBMIT1
  END DO
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS SELECTED LIBRARY, &SLSS.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    GOTO ENDRPT
  END DO
  SET BINCNT = 1
  SET SAVBOOK = &STR(&BOOK)
XICSLOOP: +
  DO WHILE &BINCNT < 4
    SET LINCNT = 1
    SET SID1 = &SUBSTR(1:12,&STR(&FS))
    SET SID2 = &SUBSTR(1:12,&STR(&FS))
    SET SID3 = &SUBSTR(1:12,&STR(&FS))
    SET SID4 = &SUBSTR(1:12,&STR(&FS))
    SET SID5 = &SUBSTR(1:12,&STR(&FS))
    SET SID6 = &SUBSTR(1:12,&STR(&FS))
    SET SID7 = &SUBSTR(1:12,&STR(&FS))
    SET SID8 = &SUBSTR(1:12,&STR(&FS))
    SET SID9 = &SUBSTR(1:12,&STR(&FS))
    SET SIDA = &SUBSTR(1:12,&STR(&FS))
    SET SIDB = &SUBSTR(1:12,&STR(&FS))
    SET SIDC = &SUBSTR(1:12,&STR(&FS))
    SET TIT1 = &SUBSTR(1:58,&STR(&FS))
    SET TIT2 = &SUBSTR(1:58,&STR(&FS))
    SET TIT3 = &SUBSTR(1:58,&STR(&FS))
    SET TIT4 = &SUBSTR(1:58,&STR(&FS))
    SET TIT5 = &SUBSTR(1:58,&STR(&FS))
    SET TIT6 = &SUBSTR(1:58,&STR(&FS))
    SET TIT7 = &SUBSTR(1:58,&STR(&FS))
    SET TIT8 = &SUBSTR(1:58,&STR(&FS))
    SET TIT9 = &SUBSTR(1:58,&STR(&FS))
    SET TITA = &SUBSTR(1:58,&STR(&FS))
    SET TITB = &SUBSTR(1:58,&STR(&FS))
    SET TITC = &SUBSTR(1:58,&STR(&FS))
    SET SLSSOUT = &STR(<SK> -------------------------------------------------------------)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<BIN&BINCNT>&BOOK                                                 )
    PUTFILE SLSSOUT
    DO WHILE &LINCNT < 13
      IF &LINCNT = 1 THEN DO
        SET SID6 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 2 THEN DO
        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 3 THEN DO
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 4 THEN DO
        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 5 THEN DO
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 6 THEN DO
        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 7 THEN DO
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 8 THEN DO
        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 9 THEN DO
        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 10 THEN DO
        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 11 THEN DO
        SET SID1 = &SUBSTR(1:12,&STR(&SID2&FS))
        SET TIT1 = &SUBSTR(1:58,&STR(&TIT2&FS))
        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
        SET SIDA = &SUBSTR(1:12,&STR(&SIDB&FS))
        SET TITA = &SUBSTR(1:58,&STR(&TITB&FS))
        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 12 THEN DO
        SET SIDC = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITC = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      SET LINCNT = &LINCNT + 1
      IF &STR(&NAME2) ^= &STR( ) THEN DO
        SET SLSID = &SUBSTR(1:9,&STR(&FS))
        SET SLSSVER = &SUBSTR(1:2,&STR(&FS))
        SET NAME1 = &STR(&NAME2)
        SET NAME2 = &STR( )
      END DO
      ELSE DO
        ISPEXEC TBVCLEAR &SLSS
        ISPEXEC TBSKIP &SLSS NUMBER(+1)
        SET RC = &LASTCC
        IF &RC = 8 THEN DO
          ISPEXEC TBEND &SLSS
          WRITE ========================================
          WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
          WRITE ========================================
          GOTO SUBMIT1
        END DO
        IF &RC ^= 0 THEN DO
          WRITE UNABLE TO PROCESS SELECTED LIBRARY, &SLSS.
          WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
          WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
          WRITE INFORMATION REGARDING THIS ERROR.
          WRITE ========================================
          ISPEXEC TBEND &SLSS
          GOTO ENDRPT
        END DO
        IF &STR(&BOOK) ^= &STR(&SAVBOOK) THEN DO
          SET LINCNT = 13
          SET SAVBOOK = &STR(&BOOK)
        END DO
      END DO
    END DO
    SET SLSSOUT = &STR(<WIN&BINCNT/SID1>&SID1<TITL>&TIT1)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID2>&SID2<TITL>&TIT2)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID3>&SID3<TITL>&TIT3)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID4>&SID4<TITL>&TIT4)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID5>&SID5<TITL>&TIT5)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID6>&SID6<TITL>&TIT6)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID7>&SID7<TITL>&TIT7)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID8>&SID8<TITL>&TIT8)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID9>&SID9<TITL>&TIT9)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDA>&SIDA<TITL>&TITA)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDB>&SIDB<TITL>&TITB)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDC>&SIDC<TITL>&TITC)
    PUTFILE SLSSOUT
    SET BINCNT = &BINCNT + 1
  END DO
  SET SLSSOUT = &STR(<NP>)
  PUTFILE SLSSOUT
  SET BINCNT = 1
  SET SAVBOOK = &STR(&BOOK)
  GOTO XICSLOOP
RPT6: +
  IF &SLSSRPT ^= &STR(6) THEN GOTO RPT7
  SET SLSSPRNT = &STR(SLSSXICS)
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(&SLSS)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN BOOKIDS NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN SELECTED LIBRARY, BOOKIDS.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND BOOKIDS
    GOTO ENDRPT
  END DO
  ISPEXEC TBVCLEAR BOOKIDS
  ISPEXEC TBSKIP BOOKIDS NUMBER(+1)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE EXTRACT REQUESTED LABELS FROM BOOKIDS.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND BOOKIDS
    GOTO ENDRPT
  END DO
  ISPEXEC TBOPEN &SLSS NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN SELECTED LIBRARY, &SLSS.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    ISPEXEC TBEND BOOKIDS
    GOTO ENDRPT
  END DO
SORT6: +
  ISPEXEC TBSORT &SLSS FIELDS(BOOK,C,A,SLSSRTKY,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, &SLSS, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND &SLSS
    ISPEXEC TBEND BOOKIDS
    GOTO ENDRPT
  END DO
  SET SLSSOUT = &STR(<HYP,0,0,0>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<FNT1=F,2,1/PT,11,12>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<FNT2=F,2,1/PT,18,20>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN1=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,180,34>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN2=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,354,208>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#BIN3=<FNT2/PD,760/PW,542/R,1,1/SP,590/QL,528,382>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN1=<PD,542/PW,760/R,2,1/PT,11,0/SP,10/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN2=<PD,542/PW,760/R,2,1/PT,11,0/SP,184/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#WIN3=<PD,542/PW,760/R,2,1/PT,11,0/SP,358/BOX,750,154,10,5,0,1,>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID1=<FNT1/SP,1/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID2=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID3=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID4=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID5=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID6=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID7=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID8=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SID9=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDA =<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDB=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#SIDC=<FNT1/NL/QL,280,200>>)
  PUTFILE SLSSOUT
  SET SLSSOUT = &STR(<#TITL=<FNT1/QL,690,296>>)
  PUTFILE SLSSOUT
  SET CNTR = 1
  SET BINCNT = 1
BOOKLOOP: +
  DO WHILE &BINCNT < 4
    ISPEXEC TBTOP &SLSS
    ISPEXEC TBVCLEAR &SLSS
    SET TEMP = &STR(&&BID&CNTR)
    SET BOOK = &STR(&TEMP)
    IF &STR(&BOOK) = &STR( ) THEN DO
      ISPEXEC TBEND &SLSS
      ISPEXEC TBEND BOOKIDS
      WRITE ========================================
      WRITE BINDER LABEL PROCESSING COMPLETE FOR LIBRARY, '&SLSS'.
      WRITE ========================================
      GOTO SUBMIT1
    END DO
    ISPEXEC TBSARG &SLSS
    ISPEXEC TBSCAN &SLSS ROWID(ROW#) NEXT
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      WRITE UNABLE TO PRINT LABEL FOR SELECTED BINDER, &BOOK.
      WRITE RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
      WRITE WILL ATTEMPT TO PRINT OTHER SELECTIONS.
      WRITE ========================================
      SET CNTR = &CNTR + 1
      GOTO BOOKLOOP
    END DO
    SET LINCNT = 1
    SET SID1 = &SUBSTR(1:12,&STR(&FS))
    SET SID2 = &SUBSTR(1:12,&STR(&FS))
    SET SID3 = &SUBSTR(1:12,&STR(&FS))
    SET SID4 = &SUBSTR(1:12,&STR(&FS))
    SET SID5 = &SUBSTR(1:12,&STR(&FS))
    SET SID6 = &SUBSTR(1:12,&STR(&FS))
    SET SID7 = &SUBSTR(1:12,&STR(&FS))
    SET SID8 = &SUBSTR(1:12,&STR(&FS))
    SET SID9 = &SUBSTR(1:12,&STR(&FS))
    SET SIDA = &SUBSTR(1:12,&STR(&FS))
    SET SIDB = &SUBSTR(1:12,&STR(&FS))
    SET SIDC = &SUBSTR(1:12,&STR(&FS))
    SET TIT1 = &SUBSTR(1:58,&STR(&FS))
    SET TIT2 = &SUBSTR(1:58,&STR(&FS))
    SET TIT3 = &SUBSTR(1:58,&STR(&FS))
    SET TIT4 = &SUBSTR(1:58,&STR(&FS))
    SET TIT5 = &SUBSTR(1:58,&STR(&FS))
    SET TIT6 = &SUBSTR(1:58,&STR(&FS))
    SET TIT7 = &SUBSTR(1:58,&STR(&FS))
    SET TIT8 = &SUBSTR(1:58,&STR(&FS))
    SET TIT9 = &SUBSTR(1:58,&STR(&FS))
    SET TITA = &SUBSTR(1:58,&STR(&FS))
    SET TITB = &SUBSTR(1:58,&STR(&FS))
    SET TITC = &SUBSTR(1:58,&STR(&FS))
    SET SLSSOUT = &STR(<SK> -------------------------------------------------------------)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<BIN&BINCNT>&BOOK                                                 )
    PUTFILE SLSSOUT
    DO WHILE &LINCNT < 13
      IF &LINCNT = 1 THEN DO
        SET SID6 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 2 THEN DO
        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 3 THEN DO
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 4 THEN DO
        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 5 THEN DO
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 6 THEN DO
        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 7 THEN DO
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 8 THEN DO
        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 9 THEN DO
        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
        SET SIDA = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITA = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 10 THEN DO
        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 11 THEN DO
        SET SID1 = &SUBSTR(1:12,&STR(&SID2&FS))
        SET TIT1 = &SUBSTR(1:58,&STR(&TIT2&FS))
        SET SID2 = &SUBSTR(1:12,&STR(&SID3&FS))
        SET TIT2 = &SUBSTR(1:58,&STR(&TIT3&FS))
        SET SID3 = &SUBSTR(1:12,&STR(&SID4&FS))
        SET TIT3 = &SUBSTR(1:58,&STR(&TIT4&FS))
        SET SID4 = &SUBSTR(1:12,&STR(&SID5&FS))
        SET TIT4 = &SUBSTR(1:58,&STR(&TIT5&FS))
        SET SID5 = &SUBSTR(1:12,&STR(&SID6&FS))
        SET TIT5 = &SUBSTR(1:58,&STR(&TIT6&FS))
        SET SID6 = &SUBSTR(1:12,&STR(&SID7&FS))
        SET TIT6 = &SUBSTR(1:58,&STR(&TIT7&FS))
        SET SID7 = &SUBSTR(1:12,&STR(&SID8&FS))
        SET TIT7 = &SUBSTR(1:58,&STR(&TIT8&FS))
        SET SID8 = &SUBSTR(1:12,&STR(&SID9&FS))
        SET TIT8 = &SUBSTR(1:58,&STR(&TIT9&FS))
        SET SID9 = &SUBSTR(1:12,&STR(&SIDA&FS))
        SET TIT9 = &SUBSTR(1:58,&STR(&TITA&FS))
        SET SIDA = &SUBSTR(1:12,&STR(&SIDB&FS))
        SET TITA = &SUBSTR(1:58,&STR(&TITB&FS))
        SET SIDB = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITB = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      IF &LINCNT = 12 THEN DO
        SET SIDC = &SUBSTR(1:12,&STR(&SLSID-&SLSSVER&FS))
        SET TITC = &SUBSTR(1:58,&STR(&NAME1&FS))
      END DO
      SET LINCNT = &LINCNT + 1
      IF &STR(&NAME2) ^= &STR( ) THEN DO
        SET SLSID = &SUBSTR(1:9,&STR(&FS))
        SET SLSSVER = &SUBSTR(1:2,&STR(&FS))
        SET NAME1 = &STR(&NAME2)
        SET NAME2 = &STR( )
      END DO
      ELSE DO
        ISPEXEC TBVCLEAR &SLSS
        ISPEXEC TBSKIP &SLSS ROW(&ROW#) NOREAD
        SET BOOK = &STR(&TEMP)
        ISPEXEC TBSARG &SLSS
        ISPEXEC TBSCAN &SLSS ROWID(ROW#) NEXT
        SET RC = &LASTCC
        IF &RC = 8 THEN GOTO SETOUT
        IF &RC ^= 0 THEN DO
          WRITE UNABLE TO PRINT LABEL FOR SELECTED BINDER, &BOOK.
          WRITE RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
          WRITE WILL ATTEMPT TO PRINT OTHER SELECTIONS.
          WRITE ========================================
          SET CNTR = &CNTR + 1
          GOTO BOOKLOOP
        END DO
      END DO
    END DO
SETOUT: +
    SET SLSSOUT = &STR(<WIN&BINCNT/SID1>&SID1<TITL>&TIT1)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID2>&SID2<TITL>&TIT2)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID3>&SID3<TITL>&TIT3)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID4>&SID4<TITL>&TIT4)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID5>&SID5<TITL>&TIT5)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID6>&SID6<TITL>&TIT6)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID7>&SID7<TITL>&TIT7)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID8>&SID8<TITL>&TIT8)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SID9>&SID9<TITL>&TIT9)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDA>&SIDA<TITL>&TITA)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDB>&SIDB<TITL>&TITB)
    PUTFILE SLSSOUT
    SET SLSSOUT = &STR(<SIDC>&SIDC<TITL>&TITC)
    PUTFILE SLSSOUT
    SET BINCNT = &BINCNT + 1
    SET CNTR = &CNTR + 1
  END DO
  SET SLSSOUT = &STR(<NP>)
  PUTFILE SLSSOUT
  SET BINCNT = 1
  GOTO BOOKLOOP
RPT7: +
  IF &SLSSRPT ^= &STR(7) THEN GOTO ENDRPT
  SET SLSSPRNT = &STR(SLSSLOCS)
  ISPEXEC TBOPEN MAIN NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN COMPLETE LIBRARY, MAIN.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    GOTO ENDRPT
  END DO
  ISPEXEC TBOPEN MAINLOCS NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN LOCATION LIBRARY, MAINLOCS.
    WRITE RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    ISPEXEC TBEND MAINLOCS
    GOTO ENDRPT
  END DO
SORT7: +
  ISPEXEC TBSORT MAIN FIELDS(SLSSRTKY,C,A)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY, MAIN, FOR SORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSORT' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    ISPEXEC TBEND MAINLOCS
    GOTO ENDRPT
  END DO
  ISPEXEC TBTOP MAIN
LOOPTBL7: +
  ISPEXEC TBSKIP MAIN NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND MAIN
    ISPEXEC TBEND MAINLOCS
    WRITE ========================================
    WRITE REPORT PROCESSING COMPLETE MANUALS BY LOCATION.
    WRITE ========================================
    GOTO SUBMIT1
  END DO
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO PROCESS LIBRARY MAIN FOR REPORT.
    WRITE RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER
    WRITE INFORMATION REGARDING THIS ERROR.
    WRITE ========================================
    ISPEXEC TBEND MAIN
    ISPEXEC TBEND MAINLOCS
    GOTO ENDRPT
  END DO
  ISPEXEC TBTOP MAINLOCS
  ISPEXEC TBVCLEAR MAINLOCS
  SET LOCID = &STR(MAIN&SLSID)
  ISPEXEC TBSARG MAINLOCS
  ISPEXEC TBSCAN MAINLOCS
  SET RC = &LASTCC
  IF &RC > 8 THEN DO
    WRITE &STR(UNABLE TO PROCESS LOCATION LIBRARY FOR ''&SLSID''.)
    WRITE RETURN CODE FROM 'ISPEXEC TBSCAN' WAS &RC.
    WRITE PROCESS WILL CONTINUE FOR REMAINING MANUALS.
    WRITE ========================================
    GOTO LOOPTBL7
  END DO
  SET CNTR = 1
  DO WHILE &CNTR < 61
    SET TEMP = &STR(&&LOC&CNTR)
    SET LOCATN = &STR(&TEMP)
    IF &STR(&LOCATN) = &STR( ) THEN DO
      SET CNTR = 61
    END DO
    ELSE DO
      SET &SLSSOUT = &STR(&FS)
      SET R1 = &SUBSTR(1:8,&STR(&LOCATN&FS))
      SET R2 = &SUBSTR(1:9,&STR(&SLSID&FS))
      SET R3 = &SUBSTR(1:60,&STR(&NAME1&FS))
      SET &SLSSOUT = &STR(&R1 &R2 &R3)
      PUTFILE SLSSOUT
      SET CNTR = &CNTR + 1
    END DO
  END DO
  GOTO LOOPTBL7
SUBMIT1: +
  CLOSFILE SLSSOUT
  FREE F(SLSSOUT)
  ISPEXEC TBEND  SLSSPROF
  ISPEXEC TBOPEN SLSSPROF
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    WRITE UNABLE TO OPEN YOUR SLSS PROFILE.
    WRITE RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    GOTO ENDRPT
  END DO
  ISPEXEC TBTOP SLSSPROF
  ISPEXEC TBVCLEAR SLSSPROF
  SET SLSSUSR = &STR(&SYSUID)
  ISPEXEC TBSKIP SLSSPROF
  SET SKIPRC = &LASTCC
  IF &SKIPRC ^= 0 THEN DO
    WRITE UNABLE TO OBTAIN INFORMATION FROM YOUR SLSS PROFILE.
    WRITE RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &SKIPRC..
    WRITE CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    WRITE REGARDING THIS ERROR.
    WRITE ========================================
    GOTO ENDRPT
  END DO
SUBMIT2: +
  SET SLSSINDX = &SLSSINDX + 1
  IF &SLSSINDX = 27 THEN SET SLSSINDX = 1
  SET TEMPNAME = &STR(//&SLSSUSR.&SUBSTR(&SLSSINDX:&SLSSINDX,&STR(ABCDEFGHIJKLMNOPQRSTUVWXYZ&FS)))
  SET TEMPLEN = &LENGTH(&STR(&SLSSJOB1))
  SET SLSSJOB1 = &STR(&TEMPNAME.&SUBSTR(10:&TEMPLEN,&SLSSJOB1&FS))
  ISPEXEC TBPUT SLSSPROF
  ISPEXEC TBCLOSE SLSSPROF
  ISPEXEC VPUT (SLSSJOB1 SLSSJOB2 SLSSJOB3 SLSSJOB4 SLSSDSN SLSSRPT SLSSPRT SLSSLINE SLSSFORM)
  SET TIME = &STR(&SYSTIME)
  SET HOUR = &SUBSTR(1:2,&TIME&FS)
  SET MIN = &SUBSTR(4:5,&TIME&FS)
  SET SEC = &SUBSTR(7:8,&TIME&FS)
  SET SLSSFT = &STR(&SLSSUSR..T&HOUR&MIN&SEC..TEMPFT)
  ALLOC F(ISPFILE) DA(&SLSSFT) NEW CATALOG SPACE(1 1) CYLINDER LRECL(80) BLKSIZE(3120) RECFM(F B) DSORG(PS)
  ISPEXEC FTOPEN
  ISPEXEC FTINCL &SLSSPRNT
  ISPEXEC FTCLOSE
  SUBMIT '&SLSSFT'
  DELETE &SLSSFT
  EXIT CODE(00)
ENDRPT: +
  CLOSFILE SLSSOUT
  FREE F(SLSSOUT)
  EXIT CODE(00)
