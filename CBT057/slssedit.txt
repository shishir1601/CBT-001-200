PROC 0
    ISPEXEC VGET (DEBUG SLSS CIBSRTKY CIBNUMBR LIBADMIN CIBOWNER CHGFLG) SHARED
    IF &DEBUG = DEBUG THEN DO
        CONTROL MSG LIST CONLIST SYMLIST
    END DO
    ELSE DO
        CONTROL NOMSG
    END DO
    SET SELECT   = &STR( )
    SET FUNC     = &STR( )
    SET MOD      = &STR(N)
    SET LOCSOPEN = &STR(N)
PROCESS: +
    ISPEXEC CONTROL ERRORS RETURN
    ISPEXEC TBOPEN &SLSS LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC = 12 THEN DO
      SET SLSSERR1 = LIBRARY IS CURRENTLY OPEN FOR EDIT BY ANOTHER
      SET SLSSERR2 = USER.  PLEASE TRY PROCESS AT A LATER TIME.
      SET SLSSERR3 =
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND &SLSS
      EXIT
    END DO
    IF &RC = 8 THEN DO
      SET SLSSERR1 = REQUESTED LIBRARY, &SLSS,  DOES NOT EXIST.
      SET SLSSERR2 = CONTACT LIBRARY ADMINISTRATOR, &LIBADMIN
      SET SLSSERR3 = FOR FURTHER INFORMATION REGARDING THIS ERROR.
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND &SLSS
      EXIT
    END DO
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = ERROR OPENING LIBRARY &SLSS.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC.
      SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
      SET SLSSERR4 = CONCERNING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND &SLSS
      EXIT
    END DO
    ISPEXEC VPUT (SLSS DEBUG) SHARED
    %SLSSENQ ENQON
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      ISPEXEC TBEND &SLSS
      EXIT
    END DO
    GOTO SHOWIT
SHOWIT: +
    IF &FUNC = A THEN GOTO ADD
    SET CREATE =
    ISPEXEC CONTROL DISPLAY REFRESH
    ISPEXEC TBDISPL &SLSS PANEL(SLSS)
    SET LCC = &LASTCC
    SET ADDMSG = &STR(  )
    IF &LCC = 0 THEN GOTO TESTOPT
    IF &LCC = 4 THEN GOTO UPDATE
    IF &LCC = 8 THEN GOTO CLOSE
    SET SLSSERR1 = UNABLE TO DISPLAY REQUESTED LIBRARY.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDISPL' WAS &LCC.
    SET SLSSERR3 =
    SET SLSSERR4 =
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    GOTO CLOSE
TESTOPT:  +
    IF &STR(&OPT) = C THEN GOTO EXIT
    IF &STR(&OPT) = A THEN GOTO ADDS
    IF &STR(&OPT) = SAVE THEN GOTO SAVEIT
    IF &SELECT = D THEN GOTO DELETE
    IF &SELECT = S THEN GOTO REFRESH
    IF &STR(&OPT) = THEN GOTO SHOWIT
    ISPEXEC TBVCLEAR &SLSS
    SET SLSID = &STR(&OPT.*)
    ISPEXEC TBSARG &SLSS
    ISPEXEC TBSCAN &SLSS
    SET LCC = &LASTCC
    IF &LCC = 0 THEN GOTO SHOWIT
    IF &LCC = 8 THEN DO
      SET SLSSCAU1 = &STR(ENTRY '&SLSID' NOT FOUND IN LIBRARY)
      SET SLSSCAU2 =
      SET SLSSCAU3 =
      SET SLSSCAU4 =
      SET SLSSCAU5 =
      SET SLSSCAUX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@CAU)
    END DO
    GOTO SHOWIT
SAVEIT:  +
    ISPEXEC TBSAVE &SLSS PAD(30) LIBRARY(SLSSTLIB)
    SET CHGFLG = &STR(Y)
    GOTO REFRESH
ADDS:  +
    ISPEXEC TBVCLEAR &SLSS
ADD:     +
    ISPEXEC DISPLAY PANEL(SLSSADD)
    IF &LASTCC > 0 THEN GOTO NOADD
    ISPEXEC VPUT (NAME1 NAME2 NAME3)
    ISPEXEC SELECT PGM(SLSSVEFY)
    ISPEXEC VGET (NAME1 NAME2 NAME3)
    IF &STR(&SLSID) = &STR( ) THEN GOTO ADD
    SET SLSSVER = &SUBSTR(1:2,&STR(&SLSSVER   ))
    SET SLSID = &SUBSTR(1:9,&STR(&SLSID            ))
    SET SLSSRTKY = &SUBSTR(2:9,&STR(&SLSID            ))
    IF &STR(&DATEORD) = &STR( ) THEN DO
        SET DATEORD = &STR(        )
        SET ORDSTS  = &STR( )
    END DO
    ELSE DO
        SET ORDSTS  = &STR(*)
    END DO
    IF &STR(&DATERECV) = &STR( ) THEN DO
        SET DATERECV = &STR(        )
    END DO
    SET CRETWHO = &SYSUID
    SET CRETDAT = &STR(&SYSDATE)
    SET CRETTIM = &STR(&SYSSTIME)
    SET LSTUWHO = &STR(  )
    SET LSTUDAT = &STR(  )
    SET LSTUTIM = &STR(  )
    ISPEXEC TBADD &SLSS
    SET RC = &LASTCC
    IF &RC = 0 THEN DO
      SET ADDMSG = &STR(ENTRY &SLSID ADDED)
      SET MOD = &STR(Y)
      SET CHGFLG = &STR(Y)
    END DO
    IF &RC = 8 THEN DO
      SET SLSSERR1 = &STR(ENTRY &SLSID ALREADY EXISTS.)
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBADD' WAS &RC.
      SET SLSSERR3 =
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      GOTO ADD
    END DO
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO COMPLETE REQUESTED FUNCTION.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBADD' WAS &RC.
      SET SLSSERR3 = PLEASE TRY PROCESS AGAIN.
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      GOTO ADD
    END DO
    IF &SELECT = R THEN GOTO SHOWIT
    IF &LOCS = Y THEN GOTO PROCLOCS
    ISPEXEC TBOPEN MAIN WRITE LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, MAIN)
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
    END DO
    ELSE DO
      ISPEXEC TBMOD MAIN ORDER
      ISPEXEC TBCLOSE MAIN LIBRARY(SLSSTLIB)
    END DO
    GOTO ADD
NOADD:  +
    SET FUNC = D
    GOTO SHOWIT
DELETE:  +
    SET ADDMSG = &STR(    )
    SET SLSSPRC1 = &STR(CONFIRM REQUEST TO DELETE ENTRY &SLSID.)
    SET SLSSPRC2 =
    SET SLSSPRC3 = PRESS ENTER TO CONFIRM REQUEST.
    SET SLSSPRC4 = PRESS END KEY TO TERMINATE REQUEST.
    SET SLSSPRC5 =
    SET SLSSPRCX = PRESS ENTER TO CONFIRM, END KEY TO TERMINATE.
    ISPEXEC DISPLAY PANEL(SLSS@PRC)
    SET RC = &LASTCC
    IF &RC = 8 THEN DO
      SET ADDMSG = &STR(DELETE REQUEST FOR ENTRY &SLSID TERMINATED)
      GOTO SHOWIT
    END DO
    ISPEXEC TBDELETE &SLSS
    SET RC = &LASTCC
    IF &RC = 0 THEN DO
      SET ADDMSG = &STR(ENTRY &SLSID DELETED )
      SET MOD = &STR(Y)
      SET CHGFLG = &STR(Y)
      IF &SLSS = &STR(MAIN) THEN DO
        IF &LOCSOPEN = &STR(N) THEN DO
          ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
          SET OPENRC = &LASTCC
          IF &OPENRC ^= 0 THEN DO
            SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
            SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
            SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
            SET SLSSERR4 = CONCERNING THIS ERROR.
            SET SLSSERR5 =
            SET SLSSERRX = PRESS ENTER TO CONTINUE
            ISPEXEC DISPLAY PANEL(SLSS@ERR)
            ISPEXEC TBEND MAINLOCS
            GOTO SHOWIT
          END DO
          SET LOCSOPEN = &STR(Y)
        END DO
        SET LOCID = &STR(MAIN&SLSID)
        ISPEXEC TBGET MAINLOCS
        IF &LASTCC ^= 0 THEN GOTO TBDEL
        ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
        SET RC = &LASTCC
        IF &RC = 12 THEN DO
          SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
          SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
          SET SLSSERR4 = REGARDING THIS ERROR.
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          GOTO TBDEL
        END DO
        IF &RC ^= 0 THEN DO
          SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
          SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
          SET SLSSERR4 = REGARDING THIS ERROR.
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          GOTO TBDEL
        END DO
        SET CNT = 1
        ISPEXEC TBVCLEAR MAINMEMS
        SET PF  = &STR(&&LOC&CNT)
        SET MEMBER = &STR(&PF)
        IF &MEMBER = &STR() THEN SET &CNT = 61
        DO WHILE &CNT < 61
          ISPEXEC TBTOP MAINMEMS
          ISPEXEC TBSARG MAINMEMS
          ISPEXEC TBSCAN MAINMEMS
          SET RC = &LASTCC
          IF &RC ^= 0 THEN DO
            SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
            SET SLSSERR2 = &STR(&SLSID CANNOT BE DELETED FROM THE LIBRARY)
            SET SLSSERR3 = ASSOCIATED WITH &MEMBER..
            SET SLSSERR4 =
            SET SLSSERR5 =
            SET SLSSERRX = PRESS ENTER TO CONTINUE
            ISPEXEC DISPLAY PANEL(SLSS@ERR)
          END DO
          ELSE DO
            IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
              SET SUBLIB = &STR(&MEMBER)
            END DO
            IF &SUBLIB ^= &SLSS THEN DO
              ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
              SET RC = &LASTCC
              IF &RC ^= 0 THEN DO
                SET SLSSERR1 = &STR(UNABLE TO DELETE &SLSID FROM LIBRARY, &SUBLIB.)
                SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
                SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
                SET SLSSERR4 = REGARDING THIS ERROR.
                SET SLSSERR5 =
                SET SLSSERRX = PRESS ENTER TO CONTINUE
                ISPEXEC DISPLAY PANEL(SLSS@ERR)
              END DO
              ELSE DO
                ISPEXEC TBDELETE &SUBLIB
                ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
              END DO
            END DO
          END DO
          SET CNT = &CNT + 1
          ISPEXEC TBVCLEAR MAINMEMS
          SET PF  = &STR(&&LOC&CNT)
          SET MEMBER = &STR(&PF)
          IF &MEMBER = &STR() THEN SET &CNT = 61
        END DO
        ISPEXEC TBEND MAINMEMS
TBDEL: +
        ISPEXEC TBDELETE MAINLOCS
        ISPEXEC TBCLOSE MAINLOCS LIBRARY(SLSSTLIB)
        SET CLOSRC = &LASTCC
        IF &CLOSRC ^= 0 THEN DO
          SET SLSSERR1 = ERROR CLOSING LIBRARY MAINLOCS
          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBCLOSE' WAS &CLOSRC.
          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
          SET SLSSERR4 = CONCERNING THIS ERROR.
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          ISPEXEC TBEND MAINLOCS
          SET LOCSOPEN = &STR(N)
          GOTO SHOWIT
        END DO
        SET LOCSOPEN = &STR(N)
      END DO
    END DO
    ELSE DO
      SET SLSSWRN1 = UNABLE TO COMPLETE REQUEST TO DELETE ENTRY.
      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBDELETE' WAS &RC.
      SET SLSSWRN3 =
      SET SLSSWRN4 =
      SET SLSSWRN5 =
      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@WRN)
    END DO
    GOTO SHOWIT
UPDATE:  +
    IF &SELECT = D THEN GOTO DELETE
    SET ADDMSG = &STR(    )
    IF &STR(&DATEORD) = &STR( ) THEN DO
        SET DATEORD = &STR(        )
        SET ORDSTS = &STR( )
    END DO
    ELSE DO
        SET ORDSTS = &STR(*)
    END DO
    IF &STR(&DATERECV) = &STR( ) THEN DO
        SET DATERECV = &STR(        )
    END DO
    SET LSTUWHO = &STR(&SYSUID)
    SET LSTUDAT = &STR(&SYSDATE)
    SET LSTUTIM = &STR(&SYSSTIME)
    ISPEXEC TBMOD &SLSS
    SET RC = &LASTCC
    IF &RC = 0 THEN DO
        SET ADDMSG = &STR(ENTRY &SLSID MODIFIED )
        SET CHGFLG = &STR(Y)
    END DO
    IF &RC = 8 THEN DO
      SET SLSSWRN1 = &STR(ENTRY &SLSID DID NOT EXIST, BUT WAS ADDED.)
      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
      SET SLSSWRN3 =
      SET SLSSWRN4 =
      SET SLSSWRN5 =
      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@WRN)
      IF &LOCS = Y THEN GOTO PROCLOCS
      GOTO SHOWIT
    END DO
    IF &RC ^= 0 THEN DO
      SET SLSSWRN1 = UNABLE TO COMPLETE REQUEST TO UPDATE ENTRY.
      SET SLSSWRN2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
      SET SLSSWRN3 =
      SET SLSSWRN4 =
      SET SLSSWRN5 =
      SET SLSSWRNX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@WRN)
    END DO
    IF &LOCS = Y THEN GOTO PROCLOCS
    IF &SLSS = &STR(MAIN) THEN DO
      IF &LOCSOPEN = &STR(N) THEN DO
        ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
        SET OPENRC = &LASTCC
        IF &OPENRC ^= 0 THEN DO
          SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
          SET SLSSERR4 = CONCERNING THIS ERROR.
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          ISPEXEC TBEND MAINLOCS
          GOTO SHOWIT
        END DO
        SET LOCSOPEN = &STR(Y)
      END DO
      SET LOCID = &STR(MAIN&SLSID)
      ISPEXEC TBGET MAINLOCS
      IF &LASTCC ^= 0 THEN GOTO SHOWIT
      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
      SET RC = &LASTCC
      IF &RC = 12 THEN DO
        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO SHOWIT
      END DO
      IF &RC ^= 0 THEN DO
        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO SHOWIT
      END DO
      SET CNT = 1
      ISPEXEC TBVCLEAR MAINMEMS
      SET PF  = &STR(&&LOC&CNT)
      SET MEMBER = &STR(&PF)
      IF &MEMBER = &STR() THEN SET &CNT = 61
      DO WHILE &CNT < 61
        ISPEXEC TBTOP MAINMEMS
        ISPEXEC TBSARG MAINMEMS
        ISPEXEC TBSCAN MAINMEMS
        SET RC = &LASTCC
        IF &RC ^= 0 THEN DO
          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
        END DO
        ELSE DO
          IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
            SET SUBLIB = &STR(&MEMBER)
          END DO
          IF &SUBLIB ^= &SLSS THEN DO
            ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
            SET RC = &LASTCC
            IF &RC ^= 0 THEN DO
              SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
              SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
              SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
              SET SLSSERR4 = REGARDING THIS ERROR.
              SET SLSSERR5 =
              SET SLSSERRX = PRESS ENTER TO CONTINUE
              ISPEXEC DISPLAY PANEL(SLSS@ERR)
            END DO
            ELSE DO
              ISPEXEC TBMOD &SUBLIB ORDER
              ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
            END DO
          END DO
        END DO
        SET CNT = &CNT + 1
        ISPEXEC TBVCLEAR MAINMEMS
        SET PF  = &STR(&&LOC&CNT)
        SET MEMBER = &STR(&PF)
        IF &MEMBER = &STR() THEN SET &CNT = 61
      END DO
      ISPEXEC TBEND MAINMEMS
    END DO
    GOTO SHOWIT
REFRESH:  +
    SET EXTFLAG = &STR(NO)
    SET OLDID = &STR(&SLSID)
    SET ADDMSG = &STR(    )
    ISPEXEC DISPLAY PANEL(SLSSADD)
    IF &LASTCC >0 THEN SET EXTFLAG = &STR(YES)
    ISPEXEC VPUT (NAME1 NAME2 NAME3)
    ISPEXEC SELECT PGM(SLSSVEFY)
    ISPEXEC VGET (NAME1 NAME2 NAME3)
    SET SLSSVER = &SUBSTR(1:2,&STR(&SLSSVER  ))
    SET SLSID = &SUBSTR(1:9,&STR(&SLSID           ))
    IF &STR(&DATEORD) = &STR( ) THEN DO
        SET DATEORD = &STR(        )
        SET ORDSTS = &STR( )
    END DO
    ELSE DO
        SET ORDSTS = &STR(*)
    END DO
    IF &STR(&DATERECV) = &STR( ) THEN DO
        SET DATERECV = &STR(        )
    END DO
    SET LSTUWHO = &STR(&SYSUID)
    SET LSTUDAT = &STR(&SYSDATE)
    SET LSTUTIM = &STR(&SYSSTIME)
    ISPEXEC TBMOD &SLSS
    SET RC = &LASTCC
    IF &RC = 0 THEN DO
        SET ADDMSG = &STR(ENTRY &SLSID MODIFIED )
        SET MOD = &STR(Y)
        SET CHGFLG = &STR(Y)
    END DO
    IF &RC = 8 THEN DO
      ISPEXEC TBDELETE &SLSS
      SET SLSSERR1 = ENTRY WAS NOT MODIFIED.  TO ADD NEW A NEW ENTRY
      SET SLSSERR2 = ENTER OPTION 'A' ON MAINTENANCE SELECTION PANEL.
      SET SLSSERR3 =
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      SET SLSID = &STR(&OLDID)
      ISPEXEC TBGET &SLSS
      IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
      GOTO REFRESH
    END DO
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO COMPLETE REQUEST TO UPDATE ENTRY.
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBMOD' WAS &RC.
      SET SLSSERR3 =
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@WRN)
      GOTO SHOWIT
    END DO
    IF &LOCS = Y THEN GOTO PROCLOCS
    IF &SLSS = &STR(MAIN) THEN DO
      IF &LOCSOPEN = &STR(N) THEN DO
        ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
        SET OPENRC = &LASTCC
        IF &OPENRC ^= 0 THEN DO
          SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
          SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &OPENRC.
          SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
          SET SLSSERR4 = CONCERNING THIS ERROR.
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          ISPEXEC TBEND MAINLOCS
          GOTO SHOWIT
        END DO
        SET LOCSOPEN = &STR(Y)
      END DO
      SET LOCID = &STR(MAIN&SLSID)
      ISPEXEC TBGET MAINLOCS
      IF &LASTCC ^= 0 THEN GOTO SHOWIT
      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
      SET RC = &LASTCC
      IF &RC = 12 THEN DO
        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO SHOWIT
      END DO
      IF &RC ^= 0 THEN DO
        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO SHOWIT
      END DO
      SET CNT = 1
      ISPEXEC TBVCLEAR MAINMEMS
      SET PF  = &STR(&&LOC&CNT)
      SET MEMBER = &STR(&PF)
      IF &MEMBER = &STR() THEN SET &CNT = 61
      DO WHILE &CNT < 61
        ISPEXEC TBTOP MAINMEMS
        ISPEXEC TBSARG MAINMEMS
        ISPEXEC TBSCAN MAINMEMS
        SET RC = &LASTCC
        IF &RC ^= 0 THEN DO
          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
        END DO
        ELSE DO
          IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
            SET SUBLIB = &STR(&MEMBER)
          END DO
          IF &SUBLIB ^= &SLSS THEN DO
            ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
            SET RC = &LASTCC
            IF &RC ^= 0 THEN DO
              SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
              SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
              SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
              SET SLSSERR4 = REGARDING THIS ERROR.
              SET SLSSERR5 =
              SET SLSSERRX = PRESS ENTER TO CONTINUE
              ISPEXEC DISPLAY PANEL(SLSS@ERR)
            END DO
            ELSE DO
              ISPEXEC TBMOD &SUBLIB ORDER
              ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
            END DO
          END DO
        END DO
        SET CNT = &CNT + 1
        ISPEXEC TBVCLEAR MAINMEMS
        SET PF  = &STR(&&LOC&CNT)
        SET MEMBER = &STR(&PF)
        IF &MEMBER = &STR() THEN SET &CNT = 61
      END DO
      ISPEXEC TBEND MAINMEMS
    END DO
    IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
    GOTO REFRESH
PROCLOCS: +
    IF &EXTFLAG = &STR(YES) THEN GOTO SHOWIT
    IF &LOCSOPEN = Y THEN GOTO SHOWLOCS
    ISPEXEC TBOPEN MAINLOCS LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC = 8 THEN GOTO BLDLOCS
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = ERROR OPENING LIBRARY MAINLOCS
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC.
      SET SLSSERR3 = CONTACT TECHNICAL SERVICE FOR FURTHER INFORMATION
      SET SLSSERR4 = CONCERNING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND MAINLOCS
      GOTO REFRESH
    END DO
    SET LOCSOPEN = Y
    GOTO SHOWLOCS
BLDLOCS: +
    ISPEXEC TBCREATE MAINLOCS LIBRARY(SLSSTLIB) -
    KEYS(LOCID) -
    NAMES(LOC1  LOC2  LOC3  LOC4  LOC5  LOC6  LOC7  LOC8  LOC9  LOC10 -
          LOC11 LOC12 LOC13 LOC14 LOC15 LOC16 LOC17 LOC18 LOC19 LOC20 -
          LOC21 LOC22 LOC23 LOC24 LOC25 LOC26 LOC27 LOC28 LOC29 LOC30 -
          LOC31 LOC32 LOC33 LOC34 LOC35 LOC36 LOC37 LOC38 LOC39 LOC40 -
          LOC41 LOC42 LOC43 LOC44 LOC45 LOC46 LOC47 LOC48 LOC49 LOC50 -
          LOC51 LOC52 LOC53 LOC54 LOC55 LOC56 LOC57 LOC58 LOC59 LOC60)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO CREATE THE REQUESTED LIBRARY MAINLOCS
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCREATE' WAS &RC..
      SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
      SET SLSSERR4 = INFORMATION REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND MAINLOCS
      GOTO REFRESH
    END DO
    SET LOCSOPEN = Y
SHOWLOCS: +
    SET LOCID = &STR(MAIN&SLSID)
    ISPEXEC TBGET MAINLOCS
    SET CSRFLAG = &STR(OFF)
    SET CNT = 1
    DO WHILE &CNT < 61
      SET PF  = &STR(&&LOC&CNT)
      SET SAVLOC&CNT = &STR(&PF)
      IF &STR(&PF) = &STR( ) AND &STR(&CSRFLAG) = &STR(OFF) THEN DO
        SET CSRPOS = &STR(LOC&CNT)
        SET CSRFLAG = &STR(ON)
      END DO
      SET CNT = &CNT + 1
    END DO
    ISPEXEC DISPLAY PANEL(SLSSLOCS)
    IF &LASTCC = 8 THEN GOTO REFRESH
    IF &SLSS = &STR(MAIN) THEN DO
      ISPEXEC TBOPEN MAINMEMS NOWRITE LIBRARY(SLSSTLIB)
      SET RC = &LASTCC
      IF &RC = 12 THEN DO
        SET SLSSERR1 = ENQ FAILED; MAINMEMS IN USE BY ANOTHER USER.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO REFRESH
      END DO
      IF &RC ^= 0 THEN DO
        SET SLSSERR1 = UNABLE TO OPEN SUB LIBRARY MEMBER FILE, MAINMEMS.
        SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
        SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
        SET SLSSERR4 = REGARDING THIS ERROR.
        SET SLSSERR5 =
        SET SLSSERRX = PRESS ENTER TO CONTINUE
        ISPEXEC DISPLAY PANEL(SLSS@ERR)
        GOTO REFRESH
      END DO
      SET CNT = 1
      ISPEXEC TBVCLEAR MAINMEMS
      SET PF  = &STR(&&LOC&CNT)
      SET MEMBER = &STR(&PF)
      IF &MEMBER = &STR() THEN SET &CNT = 61
      DO WHILE &CNT < 61
        ISPEXEC TBTOP MAINMEMS
        ISPEXEC TBSARG MAINMEMS
        ISPEXEC TBSCAN MAINMEMS
        SET RC = &LASTCC
        IF &RC ^= 0 THEN DO
          SET SLSSERR1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
          SET SLSSERR2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
          SET SLSSERR3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
          SET SLSSERR4 = PLEASE USE OPTION 1 UNDER ADMINISTRATION TO DEFINE &MEMBER..
          SET SLSSERR5 =
          SET SLSSERRX = PRESS ENTER TO CONTINUE
          ISPEXEC DISPLAY PANEL(SLSS@ERR)
          ISPEXEC TBEND MAINMEMS
          GOTO REFRESH
        END DO
        IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
          SET SUBLIB = &STR(&MEMBER)
        END DO
        IF &STR(&SUBLIB) ^= &STR(&SLSS) THEN DO
          ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
          SET RC = &LASTCC
          IF &RC ^= 0 THEN DO
            SET SLSSERR1 = &STR(UNABLE TO ADD &SLSID TO LIBRARY, &SUBLIB.)
            SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
            SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
            SET SLSSERR4 = REGARDING THIS ERROR.
            SET SLSSERR5 =
            SET SLSSERRX = PRESS ENTER TO CONTINUE
            ISPEXEC DISPLAY PANEL(SLSS@ERR)
          END DO
          ELSE DO
            ISPEXEC TBMOD &SUBLIB ORDER
            ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
          END DO
        END DO
        SET CNT = &CNT + 1
        ISPEXEC TBVCLEAR MAINMEMS
        SET PF  = &STR(&&LOC&CNT)
        SET MEMBER = &STR(&PF)
        IF &MEMBER = &STR() THEN SET &CNT = 61
      END DO
      SET CT = 1
      SET PF  = &STR(&&SAVLOC&CT)
      SET MEMBER1 = &STR(&PF)
      IF &STR(&OPT) ^= &STR(A) THEN DO
        DO WHILE &CT < 61
          SET FOUND = &STR(NO)
          SET CNT = 1
          DO WHILE &CNT < 61
            SET PF  = &STR(&&LOC&CNT)
            SET MEMBER = &STR(&PF)
            IF &MEMBER = &STR() THEN SET &CNT = 61
            ELSE DO
              IF &MEMBER = &STR(&MEMBER1) THEN DO
                SET &CNT = 61
                SET FOUND = &STR(YES)
              END DO
            END DO
            SET CNT = &CNT + 1
          END DO
          IF &FOUND = &STR(NO) THEN DO
            ISPEXEC TBVCLEAR MAINMEMS
            SET MEMBER = &STR(&MEMBER1)
            ISPEXEC TBTOP MAINMEMS
            ISPEXEC TBSARG MAINMEMS
            ISPEXEC TBSCAN MAINMEMS
            SET RC = &LASTCC
            IF &RC ^= 0 THEN DO
              SET SLSSWRN1 = LOCATION, &MEMBER, IS UNDEFINED TO SLSS.
              SET SLSSWRN2 = &MEMBER MUST FIRST BE DEFINED AS A SUB LIBRARY
              SET SLSSWRN3 = OF &SLSS BEFORE IT CAN BE USED AS A MANUAL LOCATION.
              SET SLSSWRN4 = &STR(MANUAL, &SLSID, WILL NOT BE DELETED FROM &SLSS..)
              SET SLSSWRN5 =
              SET SLSSWRNX = PRESS ENTER TO CONTINUE
              ISPEXEC DISPLAY PANEL(SLSS@WRN)
            END DO
            ELSE DO
              IF &STR(&SUBLIB) = &STR(MAIN) THEN DO
                SET SUBLIB = &STR(&MEMBER)
              END DO
              IF &SUBLIB ^= &SLSS THEN DO
                ISPEXEC TBOPEN &SUBLIB WRITE LIBRARY(SLSSTLIB)
                SET RC = &LASTCC
                IF &RC ^= 0 THEN DO
                  SET SLSSERR1 = &STR(UNABLE TO DELETE &SLSID FROM LIB, &SUBLIB.)
                  SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
                  SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
                  SET SLSSERR4 = REGARDING THIS ERROR.
                  SET SLSSERR5 =
                  SET SLSSERRX = PRESS ENTER TO CONTINUE
                  ISPEXEC DISPLAY PANEL(SLSS@ERR)
                END DO
                ELSE DO
                  ISPEXEC TBDELETE &SUBLIB
                  ISPEXEC TBCLOSE &SUBLIB LIBRARY(SLSSTLIB)
                END DO
              END DO
            END DO
          END DO
          SET CT = &CT + 1
          SET PF  = &STR(&&SAVLOC&CT)
          SET MEMBER1 = &STR(&PF)
          IF &MEMBER1 = &STR() THEN SET &CT = 61
        END DO
      END DO
      ISPEXEC TBEND MAINMEMS
    END DO
    ISPEXEC TBMOD MAINLOCS
    SET RC = &LASTCC
    IF &RC > 12 THEN DO
      SET SLSSERR1 = UNABLE TO ADD/UPDATE ENTRY.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBMOD' WAS &RC.
      SET SLSSERR3 =
      SET SLSSERR4 =
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
    END DO
    SET ADDMSG = &STR(ENTRY &SLSID AND LOCATIONS MODIFIED)
    SET MOD = &STR(Y)
    SET CHGFLG = &STR(Y)
    GOTO REFRESH
CLOSE: +
    ISPEXEC VPUT (SLSS DEBUG) SHARED
    %SLSSENQ ENQOFF
    ISPEXEC TBCLOSE &SLSS PAD(30) LIBRARY(SLSSTLIB)
    IF &LOCSOPEN = Y THEN DO
      ISPEXEC TBCLOSE MAINLOCS LIBRARY(SLSSTLIB)
    END DO
    IF &MOD = &STR(N) THEN EXIT
    ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO OPEN CONTROL FILE, SLSSCNTL.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      ISPEXEC VPUT (CHGFLG) SHARED
      EXIT
    END DO
    ISPEXEC TBVCLEAR SLSSCNTL
    SET CIBN = &STR(&SLSS)
    ISPEXEC TBGET SLSSCNTL
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBGET' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      ISPEXEC VPUT (CHGFLG) SHARED
      EXIT
    END DO
    ISPEXEC VGET (ZJDATE ZMONTH ZDAY ZYEAR)
    SET CIBJDATE = &STR(&ZJDATE)
    SET CIBTIME  = &STR(&SYSSTIME)
    SET CIBMDATE = &STR(&ZMONTH/&ZDAY/&ZYEAR)
    SET CIBUPDTE = &STR(Y)
    SET CHGFLG = &STR(Y)
    ISPEXEC TBPUT SLSSCNTL
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO UPDATE CONTROL FILE, SLSSCNTL.
      SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBPUT' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      ISPEXEC VPUT (CHGFLG) SHARED
    END DO
    ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
    SET RC = &LASTCC
    IF &RC ^= 0 THEN DO
      SET SLSSERR1 = UNABLE TO CLOSE CONTROL FILE, SLSSCNTL.
      SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBCLOSE' WAS &RC..
      SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
      SET SLSSERR4 = REGARDING THIS ERROR.
      SET SLSSERR5 =
      SET SLSSERRX = PRESS ENTER TO CONTINUE.
      ISPEXEC DISPLAY PANEL(SLSS@ERR)
      ISPEXEC TBEND SLSSCNTL
      EXIT
    END DO
    ISPEXEC VPUT (CHGFLG) SHARED
    EXIT
EXIT: +
    ISPEXEC VPUT (SLSS DEBUG) SHARED
    %SLSSENQ ENQOFF
    ISPEXEC TBEND &SLSS
    ISPEXEC TBEND MAINLOCS
    EXIT
