PROC 0
  ISPEXEC VGET (DEBUG SLSS CHGFLG CIBOWNER LIBADMIN) SHARED
  IF &DEBUG = &STR(DEBUG) THEN DO
      CONTROL MSG NOFLUSH LIST CONLIST SYMLIST PROMPT
  END DO
  ELSE DO
      CONTROL NOMSG NOFLUSH NOLIST NOCONLIST NOSYMLIST
  END DO
/*====================================================================*/
/*  SITE:    BLUE CROSS BLUE SHIELD OF KANSAS                         */
/*  REFER:   USER.CMDPROC(SLSS)                                       */
/*  AUTHOR:  DAVE WEILERT                                             */
/*  DOC:     SLSS DRIVER                                              */
/*                                                                    */
/*====================================================================*/
/*                                                                    */
CHKWHO: +
  IF &SYSUID = &STR(&LIBADMIN) THEN GOTO INIT
  IF &SYSUID = &STR(&CIBOWNER) THEN GOTO INIT
  SET SLSSWRN1 = USER '&SYSUID' IS UNAUTHORIZED FOR SELECTED OPTION.
  SET SLSSWRN2 = PLEASE CONTACT OWNER '&CIBOWNER' OF LIBRARY FOR
  SET SLSSWRN3 = FURTHER ASSISTANCE.
  SET SLSSWRN4 =
  SET SLSSWRN5 =
  SET SLSSWRNX = PRESS ENTER TO CONTINUE
  ISPEXEC DISPLAY PANEL(SLSS@WRN)
  EXIT
INIT: +
  ISPEXEC DISPLAY PANEL(SLSSRCOV)
  IF &LASTCC = 8 THEN DO
    EXIT
  END DO
  ISPEXEC TBEND &SLSS
  ISPEXEC TBEND &SLSS.ENQ
OPENENQ: +
  ISPEXEC TBOPEN &SLSS.ENQ LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO OPEN ENQUEUE FILE TO RESET.
    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBOPEN' WAS &RC.
    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND &SLSS.ENQ
    EXIT
  END DO
GETENQ: +
  ISPEXEC TBSKIP &SLSS.ENQ NUMBER(+1)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO OBTAIN ENQUEUE RECORD.
    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBSKIP' WAS &RC.
    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND &SLSS.ENQ
    EXIT
  END DO
  SET ENQU = &STR(    )
PUTENQ: +
  ISPEXEC TBPUT &SLSS.ENQ
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO RESET ENQUEUE RECORD.
    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBPUT' WAS &RC.
    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND &SLSS.ENQ
    EXIT
  END DO
CLOSENQ: +
  ISPEXEC TBCLOSE &SLSS.ENQ LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO CLOSE ENQUEUE FILE PROPERLY.
    SET SLSSERR2 = RETURN CODE FROM 'ISPEXEC TBPUT' WAS &RC.
    SET SLSSERR3 = PLEASE CONTACT TECHNICAL SERVICES FOR FURTHER
    SET SLSSERR4 = ASSISTANCE REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND &SLSS.ENQ
    EXIT
  END DO
  SET CHGFLG = &STR(Y)
  ISPEXEC VPUT (CHGFLG) SHARED
EXITENQ: +
  EXIT
