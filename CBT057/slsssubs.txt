PROC 0
  ISPEXEC VGET (SLSS DEBUG CHGFLG)
  IF &DEBUG = DEBUG THEN DO
      CONTROL MSG LIST CONLIST SYMLIST
  END DO
  ELSE DO
      CONTROL NOMSG
  END DO
BEGIN: +
  ISPEXEC DISPLAY PANEL(SLSSSUBS)
  SET RC = &LASTCC
  IF &RC = 8 THEN EXIT
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO DISPLAY SLSS SUB LIBRARY CREATION PANEL.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC DISPLAY' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    EXIT
  END DO
  ISPEXEC TBOPEN SLSSCNTL NOWRITE LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO OPEN SLSS CONTROL FILE, SLSSCNTL.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
  IF &STR(&SLSS) ^= &STR( ) THEN GOTO WARN1
SHOWSLSS: +
  SET SL = &STR( )
  ISPEXEC TBTOP SLSSCNTL
  ISPEXEC TBDISPL SLSSCNTL PANEL(SLSSMSTR)
  SET RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND SLSSCNTL
    GOTO BEGIN
  END DO
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO DISPLAY THE LIBRARIES IN SLSS SYSTEM.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDISPL' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    GOTO BEGIN
  END DO
  SET SLSS = &CIBN
  ISPEXEC VPUT (SLSS) SHARED
WARN1: +
  SET SLSSSAV = &STR(&SLSS)
  IF &STR(&SLSS) = &STR(ALL) THEN GOTO WARN2
  SET SLSSWRN1 = THIS UTILITY REQUIRES THAT THE LIBRARY, '&SLSS',
  SET SLSSWRN2 = IS NOT CURRENTLY BEING UPDATED.
  SET SLSSWRN3 = ANY UPDATES DONE PRIOR TO THIS SESSION WILL BE LOST.
  SET SLSSWRN4 =
  SET SLSSWRN5 =
  SET SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE.
  ISPEXEC DISPLAY PANEL(SLSS@WRN)
  SET RC = &LASTCC
  IF &RC = 0 THEN GOTO ENQ1
  ISPEXEC TBEND SLSSCNTL
  EXIT
WARN2: +
  SET SLSSWRN1 = THIS UTILITY REQUIRES THAT THE SLSS TABLE FILE
  SET SLSSWRN2 = IS NOT CURRENTLY BEING UPDATED.
  SET SLSSWRN3 = ANY UPDATES DONE PRIOR TO THIS SESSION WILL BE LOST.
  SET SLSSWRN4 =
  SET SLSSWRN5 =
  SET SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE.
  ISPEXEC DISPLAY PANEL(SLSS@WRN)
  SET RC = &LASTCC
  IF &RC = 0 THEN GOTO ENQ2
  ISPEXEC TBEND SLSSCNTL
  EXIT
ENQ1: +
  ISPEXEC VPUT (SLSS DEBUG) SHARED
  %SLSSENQ ENQTEST
  SET RC = &LASTCC
  IF &RC = 0 THEN GOTO DONE
  ELSE DO
    SET SLSSERR1 = LIBRARY '&SLSS' IS CURRENTLY BEING UPDATED.
    SET SLSSERR2 = SUB LIB BUILD MAY NOT CONTINUE AT THIS TIME.
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = &STR(PRESS ENTER TO CONTINUE.
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
ENQ2: +
  ISPEXEC TBVCLEAR SLSSCNTL
  ISPEXEC TBSKIP SLSSCNTL NUMBER(+1)
  SET RC = &LASTCC
  IF &RC = 8 THEN GOTO DONE
  IF &RC ^= 0 THEN DO
    SET SLSSWRN1 = UNABLE TO OBTAIN CONTROL FILE INFORMATION
    SET SLSSWRN2 = FOR ONE OF THE LIBRARIES. PROCESSING WILL
    SET SLSSWRN3 = CONTINUE FOR REMAINING LIBRARIES.
    SET SLSSWRN4 = RETURN CODE FOR 'ISPEXEC TBSKIP' WAS &RC.
    SET SLSSWRN5 =
    SET SLSSWRNX = PRESS ENTER TO CONTINUE.
    ISPEXEC DISPLAY PANEL(SLSS@WRN)
    GOTO ENQ2
  END DO
  SET SLSS = &STR(&CIBN)
  ISPEXEC VPUT (SLSS DEBUG) SHARED
  %SLSSENQ ENQTEST
  SET RC = &LASTCC
  IF &RC = 0 THEN GOTO ENQ2
  ELSE DO
    SET SLSSERR1 = LIBRARY '&SLSS' IS CURRENTLY BEING UPDATED.
    SET SLSSERR2 = SUB LIB BUILD MAY NOT CONTINUE AT THIS TIME.
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = &STR(PRESS ENTER TO CONTINUE.
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
DONE: +
  ISPEXEC TBEND SLSSCNTL
  SET SLSS = &STR(MAIN)
  ISPEXEC VPUT (SLSS DEBUG) SHARED
  %SLSSENQ ENQALL
  IF &LASTCC ^= 0 THEN EXIT
  ISPEXEC VPUT (SLSSSAV) SHARED
  ISPEXEC SELECT PGM(SLSSSUBL) PARM(&DEBUG)
  SET SLSS = &STR(MAIN)
  SET CHGFLG = &STR(Y)
  ISPEXEC VPUT (SLSS CHGFLG DEBUG) SHARED
  %SLSSENQ ENQOFF
  EXIT
