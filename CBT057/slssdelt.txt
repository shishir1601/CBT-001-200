PROC 0
  ISPEXEC VGET (DEBUG SLSS LIBADMIN CHGFLG) SHARED
  IF &DEBUG = &STR(DEBUG) THEN DO
      CONTROL MSG NOFLUSH LIST CONLIST SYMLIST PROMPT
  END DO
  ELSE DO
      CONTROL NOMSG NOFLUSH NOLIST NOCONLIST NOSYMLIST
  END DO
/*====================================================================*/
/*  SITE:    BLUE CROSS BLUE SHIELD OF KANSAS                         */
/*  REFER:   USER.CMDPROC(SLSS)                                       */
/*  AUTHOR:  DAVE WEILERT                                             */
/*  DOC:     SLSS DRIVER                                              */
/*                                                                    */
/*====================================================================*/
/*                                                                    */
  ISPEXEC TBEND SLSSCNTL
  ISPEXEC TBOPEN SLSSCNTL LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO OBTAIN ACCESS TO CONTROL FILE, SLSSCNTL.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
  ISPEXEC TBVCLEAR SLSSCNTL
  SET CIBN = &STR(&SLSS)
  ISPEXEC TBSARG SLSSCNTL
  ISPEXEC TBSCAN SLSSCNTL
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = &SLSS LIBRARY NOT DEFINED OR ERROR IN FILE SLSSCNTL.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBSCAN' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
CHKWHO: +
  IF &CIBOWNER = &SYSUID OR &LIBADMIN = &SYSUID THEN GOTO PROCESS
NOGO: +
  SET &SLSSWRN1 = USER '&SYSUID' UNAUTHORIZED TO DELETE LIBRARY.
  SET &SLSSWRN2 = CONTACT OWNER '&CIBOWNER' FOR FURTHER ASSISTANCE
  SET &SLSSWRN3 = WITH SELECTED OPTION.
  SET &SLSSWRN4 =
  SET &SLSSWRN5 =
  SET &SLSSWRNX = PRESS ENTER TO CONTINUE
  ISPEXEC DISPLAY PANEL(SLSS@WRN)
  ISPEXEC TBEND SLSSCNTL
  EXIT
PROCESS: +
  ISPEXEC DISPLAY PANEL(SLSSDELT)
  SET &RC = &LASTCC
  IF &RC = 8 THEN DO
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
CHKCNT: +
  SET &CHKROW = 0
  ISPEXEC TBQUERY SLSSCNTL ROWNUM(CHKROW)
  IF &CHKROW = 1 THEN DO
    SET &SLSSERR1 = ONE LIBRARY IS REQUIRED IN THE CONTROL FILE.
    SET &SLSSERR2 = IF DELETION IS OF FILE IS ALLOWED SLSS SYSTEM
    SET &SLSSERR3 = WILL NO LONGER WORK.
    SET &SLSSERR4 =
    SET &SLSSERR5 =
    SET &SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
  ISPEXEC CONTROL ERRORS RETURN
  ISPEXEC CONTROL DISPLAY REFRESH
DELTCNTL: +
  SET &CIBN = &SLSS
  ISPEXEC TBGET SLSSCNTL
  SET &RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET &SLSSWRN1 = UNABLE TO LOCATE LIBRARY IN CONTROL FILE.
    SET &SLSSWRN2 = RETURN CODE FOR 'ISPEXEC TBGET' WAS &RC..
    SET &SLSSWRN3 = PRESS ENTER TO CONTINUE PROCESSING TO DELETE
    SET &SLSSWRN4 = OTHER FILES, ELSE PRESS END TO TERMINATE
    SET &SLSSWRN5 = PROCESS.
    SET &SLSSWRNX = PRESS ENTER TO CONTINUE, END KEY TO TERMINATE
    ISPEXEC DISPLAY PANEL(SLSS@WRN)
    SET &RC = &LASTCC
    IF &RC = 8 THEN DO
      ISPEXEC TBEND SLSSCNTL
      EXIT
    END DO
    ISPEXEC TBEND SLSSCNTL
    SET &LIB4RC = 8
    GOTO DELTLIB
  END DO
CONTDELT: +
  ISPEXEC TBDELETE SLSSCNTL
  SET &LIB4RC = &LASTCC
  IF &LIB4RC = 0 THEN DO
    ISPEXEC TBCLOSE SLSSCNTL LIBRARY(SLSSTLIB)
    GOTO DELTLIB
  END DO
  SET &SLSSERR1 = UNABLE TO DELETE LIBRARY IN CONTROL FILE.
  SET &SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDELETE' WAS &LIB4RC..
  SET &SLSSERR3 =
  SET &SLSSERR4 =
  SET &SLSSERR5 =
  SET &SLSSERRX = PRESS ENTER TO CONTINUE
  ISPEXEC CONTROL DISPLAY REFRESH
  ISPEXEC DISPLAY PANEL(SLSS@ERR)
  ISPEXEC TBEND SLSSCNTL
  EXIT
DELTMEM: +
  ISPEXEC TBEND MAINMEMS
  ISPEXEC TBOPEN MAINMEMS LIBRARY(SLSSTLIB)
  SET RC = &LASTCC
  IF &RC ^= 0 THEN DO
    SET SLSSERR1 = UNABLE TO OBTAIN ACCESS TO CROSS REF FILE, MAINMEMS.
    SET SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBOPEN' WAS &RC..
    SET SLSSERR3 = CONTACT TECHNICAL SERVICES FOR FURTHER INFORMATION
    SET SLSSERR4 = REGARDING THIS ERROR.
    SET SLSSERR5 =
    SET SLSSERRX = PRESS ENTER TO CONTINUE
    ISPEXEC DISPLAY PANEL(SLSS@ERR)
    ISPEXEC TBEND MAINMEMS
    ISPEXEC TBEND SLSSCNTL
    EXIT
  END DO
  ISPEXEC TBTOP MAINMEMS
  ISPEXEC TBDELETE MAINMEMS
  SET &LIB5RC = &LASTCC
  IF &LIB5RC = 0 THEN DO
    ISPEXEC TBCLOSE MAINMEMS LIBRARY(SLSSTLIB)
    GOTO DELTLIB
  END DO
  SET &SLSSERR1 = UNABLE TO DELETE LIBRARY IN CROSS REF FILE, MAINMEMS.
  SET &SLSSERR2 = RETURN CODE FOR 'ISPEXEC TBDELETE' WAS &LIB5RC..
  SET &SLSSERR3 =
  SET &SLSSERR4 =
  SET &SLSSERR5 =
  SET &SLSSERRX = PRESS ENTER TO CONTINUE
  ISPEXEC CONTROL DISPLAY REFRESH
  ISPEXEC DISPLAY PANEL(SLSS@ERR)
  ISPEXEC TBEND MAINMEMS
  EXIT
DELTLIB: +
  ISPEXEC TBERASE &SLSS LIBRARY(SLSSTLIB)
  SET &LIB1RC = &LASTCC
DELTENQ: +
  ISPEXEC TBERASE &SLSS.ENQ LIBRARY(SLSSTLIB)
  SET &LIB2RC = &LASTCC
DELTSCN: +
  ISPEXEC TBERASE &SLSS.SCAN LIBRARY(SLSSTLIB)
  SET &LIB3RC = &LASTCC
SHOWRCS: +
  ISPEXEC CONTROL DISPLAY REFRESH
  ISPEXEC DISPLAY PANEL(SLSSDELS)
  SET CHGFLG = &STR(Y)
  ISPEXEC VPUT (CHGFLG) SHARED
  EXIT
